# 课后作业3

#### 1. 求满足下表数据以及边界条件$S''(-2) = S''(2) = 0 \  (n=3)$的三次样条插值函数$S(x)$, 并计算$S(0)$的值. 注意: 这里的$n$为小区间个数. (5分)
|        |      |      |     |      |
|:------:|:----:|:----:|:---:|:----:|
|   $x$  | -2.0 | -1.0 | 1.0 |  2.0 |
| $f(x)$ | -4.0 |  3.0 | 5.0 | 10.0 |

解: 易知,
$$h_0 = -1.0 - (-2.0) = 1.0 \quad h_1 = 1.0 - (-1.0) = 2.0 \quad h_2 = 2.0 - 1.0 = 1.0$$

由$M$关系式, 注意到, $M_0 = S''(-2) = 0,\; M_3 = S''(2) = 0$
$$
\begin{pmatrix}
    2 & \lambda_1 \\
    \mu_2 & 2 \\
\end{pmatrix}
\begin{pmatrix}
    M_1 \\
    M_2
\end{pmatrix}
=
\begin{pmatrix}
    d_1 - \mu_1 M_0 \\
    d_2 - \lambda_2 M_3
\end{pmatrix}
=
\begin{pmatrix}
    d_1 \\
    d_2
\end{pmatrix}
$$
其中:
$$\lambda_1 = \frac{h_1}{h_0 + h_1} = \frac{2}{3} \quad
\mu_2 =  \frac{h_1}{h_1 + h_2} = \frac{2}{3}$$
$$d_1 = 6f[x_0, x_1, x_2] = \frac{6}{h_0+h_1}(\frac{f(x_2) - f(x_1)}{h_1} - \frac{f(x_1) - f(x_0)}{h_0}) = -12$$
$$d_2 = 6f[x_1, x_2, x_3] = \frac{6}{h_1+h_2}(\frac{f(x_3) - f(x_2)}{h_2} - \frac{f(x_2) - f(x_1)}{h_1}) = 8$$
$$
\Rightarrow
\begin{pmatrix}
    2 & \frac{2}{3} \\
    \frac{2}{3} & 2
\end{pmatrix}
\begin{pmatrix}
    M_1 \\
    M_2
\end{pmatrix}
=
\begin{pmatrix}
    -12 \\
    8
\end{pmatrix}
\Rightarrow
\begin{pmatrix}
    M_1 \\
    M_2
\end{pmatrix}
=
\begin{pmatrix}
    -\frac{33}{4} \\
    \frac{27}{4}
\end{pmatrix}
=
\begin{pmatrix}
    -8.25 \\
    6.75
\end{pmatrix}
$$
因此, 三次样条插值多项式为
$$
S(x)= \left\{
\begin{aligned}
    -\frac{11}{8}&(x + 2)^3 + 4(x + 1) + \frac{35}{8}(x + 2), & x& \in [-2, -1] \\
    \frac{11}{16}&(x - 1)^3 + \frac{9}{16}(x + 1)^3 - \frac{17}{4}(x - 1) + \frac{1}{4}(x + 1), & x& \in [-1, 1] \\
    -\frac{9}{8}&(x - 2)^3 - \frac{31}{8}(x - 2) + 10(x - 1), & x& \in [1, 2] \\
\end{aligned}
\right.
$$
$$
\:\qquad=\left\{
\begin{aligned}
    -1.375&(x + 2.0)^3 + 8.375x + 12.75, & x& \in [-2.0, -1.0] \\
    0.6875&(x - 1.0)^3 + 0.5625(x + 1.0)^3 - 4.0x + 4.5 & x& \in [-1.0, 1.0] \\
    -1.125&(x - 2.0)^3 + 6.125x - 2.25, & x& \in [1.0, 2.0] \\
\end{aligned}
\right.
$$
得到:
$$S(0) = \frac{35}{8} = 4.375$$

---

#### 2. 利用下面的函数值表, 构造分段线性插值函数, 并计算$f(1.075)$和$f(1.175)$的近似值(保留4位小数). (5分)
|        |      |      |      |      |
|:------:|:----:|:----:|:----:|:----:|
|   $x$  | 1.05 | 1.10 | 1.15 | 1.20 |
| $f(x)$ |  2.0 | 2.20 | 2.17 | 2.35 |

解: 记分段线性插值函数$p(x)=p_i(x), i=0,1,2$, 则
$$p_0(x) = \frac{x - x_1}{x_0 - x_1} f(x_0) + \frac{x - x_0}{x_1 - x_0} f(x_1) = 4x - 2.2, \quad x \in [1.05, 1.10]$$
$$p_1(x) = \frac{x - x_2}{x_1 - x_2} f(x_1) + \frac{x - x_1}{x_2 - x_1} f(x_2) = -0.6x + 2.86, \quad x \in [1.10, 1.15]$$
$$p_2(x) = \frac{x - x_3}{x_2 - x_3} f(x_2) + \frac{x - x_2}{x_3 - x_2} f(x_3) = 3.6x - 1.97, \quad x \in [1.15, 1.20]$$

$$f(1.075) = p_0(1.075) = 2.1$$
$$f(1.175) = p_2(1.175) = 2.26$$

---

#### 3. 设$f(x) = 10x^3 + 3x + 2020$, 求$f[1,2]$和$f[1,2,3,4]$. (4分)

解:
|       |          |                   |                            |                                     |
|:-----:|:--------:|:-----------------:|:--------------------------:|:-----------------------------------:|
| $x_i$ | $f(x_i)$ | $f[x_{i-1}, x_i]$ | $f[x_{i-2}, x_{i-1}, x_i]$ | $f[x_{i-3}, x_{i-2}, x_{i-1}, x_i]$ |
|   1   |   2033   |                   |                            |                                     |
|   2   |   2106   |         73        |                            |                                     |
|   3   |   2299   |        193        |             60             |                                     |
|   4   |   2672   |        373        |             90             |                  10                 |

故 $f[1,2] = 73, \quad f[1,2,3,4]=10$

另, 由于$f(x)$为三次多项式, 其三次牛顿插值多项式与$f(x)$相同, 由牛顿插值多项式的性质可知$f[1,2,3,4]$等于三次项的系数

---

#### 4. 设$\{l_i(x)\}_{i=0}^6$是以$\{x_i=2i\}_{i=0}^6$为节点的6次Lagrange插值基函数. 试求$\sum_{i=0}^6(x_i^3 + x_i^2 + 1)l_i(x)$和$\sum_{i=0}^6(x_i^3 + x_i^2 + 1)l'_i(x)$(结果需化简). (6分)

解: 令$f(x) = x^3 + x^2 + 1$, 则

$$L_6(x) = \sum_{i=0}^6(x_i^3 + x_i^2 + 1)l_i(x) = \sum_{i=0}^6 f(x_i)l_i(x) = f(x) - R_6(x)$$

其中

$$R_6(x) = \frac{f^7(\xi)}{7!}(x-x_0)(x-x_1)\cdots(x-x_6) = 0 \quad (f^7(x) = 0, \forall x)$$

因而, $\sum_{i=0}^6(x_i^3 + x_i^2 + 1)l_i(x) = x^3 + x^2 + 1$

同时, $\sum_{i=0}^6(x_i^3 + x_i^2 + 1)l'_i(x) = (\sum_{i=0}^6(x_i^3 + x_i^2 + 1)l_i(x))' = 3x^2 + 2x$
